
<!DOCTYPE html>
<html>

<head>
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
		integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	<meta charset="UTF-8">
	<title>CV Bank</title>
	<style type="text/css">
		.form-info {
			display: flex;
			justify-content: center;
			max-width: 800px;
			width: 50%;
			margin-right: auto;
			margin-left: auto;
		}

		h1 {
			text-align: center;
		}


		.buttons {
			display: flex;
			max-width: 40%;
			margin-right: auto;
			margin-left: auto;
			margin: auto;
			display: flex;



		}

		button {
			white-space: normal;
			word-wrap: break-word;
		}

		.btn {
			white-space: nowrap;
			text-align: center;
		}

		textarea {
			width: 400px;
			margin: auto auto;

		}


		h1 {
			margin-top: 10%;
		}

		form {
			margin-top: 5%;
		}

		#file-name {
			width: 100%;
		}

		.nav ul {
			margin: 1rem 0;
		}

		.nav {
			display: flex;
			justify-content: space-around;
			background: black;
			/* text-align: center; */

		}

		li {
			display: inline;
			/* text-align: center; */
			vertical-align: 50;

		}

		/* Add a black background color to the top navigation */
		.topnav {
			position: relative;
			background-color: #333;
			overflow: hidden;
		}

		/* Style the links inside the navigation bar */
		.topnav a {
			float: left;
			color: #f2f2f2;
			text-align: center;
			padding: 14px 16px;
			text-decoration: none;
			font-size: 17px;
		}

		/* Change the color of links on hover */
		.topnav a:hover {
			background-color: #ddd;
			color: black;
		}

		/* Add a color to the active/current link */
		.topnav a.active {
			background-color: #4CAF50;
			color: white;
		}

		/* Centered section inside the top navigation */
		.topnav-centered a {
			float: none;
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
		}

		/* Right-aligned section inside the top navigation */
		.topnav-right {
			float: right;
		}

		.single-firm {
			margin-right: 5px;
			margin-left: 5px;
			border: 1px solid;
			height: fit-content;
			padding: 0 4px;
			border-radius: 4px;
			background-color: #05868e;
			color: white;
		}

		@media screen and (max-width: 990px) {
			.add-firm-button {
				margin-top: 24px;
			}
		}



		/* Responsive navigation menu - display links on top of each other instead of next to each other (for mobile devices) */
		@media screen and (max-width: 600px) {

			.topnav a,
			.topnav-right {
				float: none;
				display: block;
			}

			.topnav-centered a {
				position: relative;
				top: 0;
				left: 0;
				transform: none;
			}
		}

		#listed-firms {
			width: 50%;
			height: 70px;
			overflow: auto;
			max-width: 800px;
			overflow: auto;
			display: flex;
			justify-content: center;
			margin: 20px auto;
			border-radius: 10px;
			padding: 5px;
			flex-wrap: wrap;
		}

		.date {
			width: 180px;

		}

		.date-label {
			width: 100%;
			text-overflow: ellipsis;
			white-space: nowrap;
		}
	</style>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
</head>

<body>
	<div class="topnav">
		<a href="/candidate/new">Add a Candidate</a>
		<a href="/search-candidates">Search</a>
		<a href="/upload">Upload Folder</a>
	</div>

	<div class="container">
		<h1> Add a Candidate to the Database</h1>
		<div id="main-form form-group">

			<form id="candidate-data" action="/candidate/new" method="POST" enctype="multipart/form-data">
				<div id="name" class="form-info left-box">
					<div class="form-entity">
						<label for="first-name">First Name: <input type="text" name="first-name" class="form-control"
								placeholder="First Name" value =<%=candidate.firstName ? candidate.firstName: '' %>></label>
					</div>
					<div class="form-entity right-box">
						<label for="last-name">Last name: <input type="text" name="last-name" class="form-control"
								placeholder="Last Name" value= <%= candidate.lastName ? candidate.lastName :'' %> ></label>
					</div>
				</div>
				<div class="form-info">
					<div class="form-entity left-box">
						<label for="gender">Gender: <input type="text" name="gender" class="form-control"
								placeholder="Gender" value = <%= candidate.gender ? candidate.gender : '' %> ></label>
					</div>
					<div class="form-entity right-box">
						<label for="email">E-mail: <input type="text" name="email" class="form-control"
								placeholder="E-mail" value = <%= candidate.email ? candidate.email : '' %>></label>
					</div>
				</div>

				<div id="score" class="form-info ">
					<div class="form-entity left-box">
						<label for="score">McQuaig Score: <input type="text" name="score" placeholder="Score"
								class="form-control" value= <%= candidate.score ? candidate.score : '' %>></label>
					</div>
					<div class="form-entity right-box">
						<label for="degree">Degree:
							<input name="degree" type="text" placeholder="Degree" class="form-control" value= <%= candidate.degree ? candidate.degree : ''%>>
						</label>
					</div>
				</div>

				<div id="uni" class="form-info">
					<div class="form-entity left-box">
						<label for="uni">University <input type="text" name="uni" placeholder="University"
								class="form-control" value = <%= candidate.uni ? candidate.uni : ''%> ></label>
					</div>
					<div class="form-entity right-box">
						<label for="position">Position: <input name="position" type="text" placeholder="Position"
								class="form-control" value = <%= candidate.position ? candidate.position:'' %>></label>
					</div>
				</div>
				<div class="form-info ">
					<div class="form-entity left-box">
						<label for="salary">Expected Salary: <input type="text" name="salary" placeholder="Salary"
								class="form-control" value = <%= candidate.salary ? candidate.salary : '' %>></label>
					</div>
					<div class="form-entity right-box">
						<label for="key-words">Key Words: <input type="text" name="key-words" placeholder="Key Words"
								class="form-control" value = <%= candidate.keyWords ? candidate.keyWords : '' %>></label>
					</div>
				</div>

				<div class="form-info ">
					<div class="form-entity left-box">
						<label for="interviewer">Interviewer: <input type="text" name="interviewer"
								placeholder="Interviewing Consultant" class="form-control" value = <%= candidate.interviewer ? candidate.interviewer : '' %>></label>
					</div>
					<div class="form-entity right-box">
						<label for="data-enterer">Data Enterer: <input type="text" class="form-control" name="data-enterer"
								placeholder="This Will be dropdown" value=<%= candidate.dataEnterer ? candidate.dataEnterer : '' %> ></label>
					</div>
				</div>

				<div class="form-info ">
					<div class="form-entity left-box">
						<label for="study-field">Field of Study: <input type="text" name="study-field"
								class="form-control" placeholder="Field of Study" value=<%= candidate.studyField ? candidate.studyField : '' %> ></label>
					</div>
					<div class="form-entity right-box">
						<label for="number-of-inteviews">Number of Interviews: <input type="text"
								name="number-of-interviews" class="form-control" placeholder="Number of Interviews"
								id="interviewCount" value= <%= candidate.numberOfInterviews ? candidate.numberOfInterviews : '' %>></label><button class="btn btn-primary" id="addNumOfInterviews"
							onclick="addFirmInfoInputs(event)"> Add</button>
					</div>

				</div>
				<div id="interviewInfo">

				</div>
				<div class="form-info ">
					<div class="form-entity left-box date">
						<label class="date-label" for="date-of-interview-us">Date of Interview(us): <input type="date"
								name="date-of-interview-us" class="form-control" value=<%= candidate.dateOfInterviewUs ? candidate.dateOfInterviewUs : '' %>></label>
					</div>

					<div class="form-entity right-box date">
						<label class="date-label" for="date-of-interview-firm">Date of Interview(firm): <input
								type="date" name="date-of-interview-firm" class="form-control"></label>
					</div>
				</div>
				<div class="form-info ">
					<div class="form-entity left-box">
						<label for="likert-scale">
							Likert Score:
							<input type="number" name="likert-scale" placeholder="Likert Scale Score"
								class="form-control">
						</label>

					</div>
					<div class="form-entity right-box">
						<label for="folder-name">Folder Name:
							<input type="text" name="folder-name" placeholder="Folder Name" class="form-control">
						</label>
					</div>
				</div>
				<div>
					<div class="form-info ">
						<div class="form-entity left-box">
							Target Firms:
							<label for="firm-list"> <input type="text" name="firm-list" id="firm-list"
									class="form-control" placeholder="Target Companies" maxlength="30"></label>
						</div>


						<div class="form-entity right-box">
							<button class="btn btn-primary add-firm-button" onclick="addFirm(event)"
								style="vertical-align:text-bottom;">Add Firm name</button>
						</div>

					</div>
					<div>
						<div id="listed-firms"></div>
					</div>
					<div style="text-align: center;">
						<textarea type="text" id="notes" name="notes" placeholder="Notes" rows="7"></textarea>
					</div>

				</div>


				<div class="buttons">
					<div id="save-candidate" class="left-box">
						<button class="btn btn-primary">Save Candidate</button>
					</div>
					<div class="right-box">
						<input type="file" name="cv" id="uploader" multiple="" required>
					</div>

				</div>

				<div class="">
					<img src="#" id="uploaded-img" style="display: none;" />
				</div>
				<input type="text" name="all-firms-list" id="firm-list-invisible" style="display: none">
		</div>
		</form>

	</div>
	<script type="text/javascript">
		function readURL(input) {
			if (input.files && input.files[0]) {
				var reader = new FileReader();

				reader.onload = function (event) {
					$('#uploaded-img').attr('src', e.target.result)
						.css({ "width": "80%", "height": "auto", "display": "block" });
					console.log(e.target.result);
				}

				reader.readAsDataURL(input.files[0]);
			}
		}

		$("#uploader").change(function () {
			readURL(this);
		});
		const firmList = [];
		function addFirm(e) {

			e.preventDefault();
			const name = document.getElementById("firm-list").value;
			firmList.push(name);
			if (name) {
				$("#listed-firms").append(`<span id="${name}" class="single-firm">${name}
					<span onclick="deleteFirm(this)" style="margin-left:10px; cursor:pointer;">x</span></span>`);
			}
			$("#firm-list").val("");
			console.log("firmlist", firmList);

		}
		function deleteFirm(element) {
			const id = $(element).parent().attr('id');
			const index = firmList.indexOf(id);
			if (index > -1) {
				firmList.splice(index, 1);

			}

			console.log('firmlist', firmList);
			$(element).parent().remove();


		}
		function deleteInterviewInfo(element){
			console.log(element);
			$(element).parent().parent().remove();

		}
		function addFirmInfoInputs(element) {
			element.preventDefault();

			interviewCount = parseInt(document.getElementById("interviewCount").value);
			interviewInputAreasCount = document.getElementById("interviewInfo").childElementCount;
			console.log(interviewCount);
			if (interviewCount > 6){
				alert('The total number of interviews can not be over 6');
			}
			else {
				if (interviewCount && !interviewInputAreasCount) {
				for (let i = 0; i < interviewCount; i++) {

					
						$("#interviewInfo").append(`<div class="form-info "><div class="form-entity left-box">
													<label for="firmName${i}">
																	Firm Name:
													<input type="text" name="firmName${i}" placeholder="Firm Name" class="form-control">
												</label>

											</div>
											<div class="form-entity right-box">
												<label for="interviewDateFirm${i}">Date of Interview:
													<input type="date" name="interviewDateFirm${i}" class="form-control">
												</label>
												
												<img src='/xicon.jpeg' style="height:25px; width:25px; cursor:pointer;" onclick="deleteInterviewInfo(this)">
											</div></div>`);
					}
				}
				
				else if(interviewInputAreasCount<interviewCount){
						for (let i = 0; i < interviewCount-interviewInputAreasCount; i++) {

					
						$("#interviewInfo").append(`<div class="form-info "><div class="form-entity left-box">
													<label for="firmName${i}">
																	Firm Name:
													<input type="text" name="firmName${i}" placeholder="Firm Name" class="form-control">
												</label>

											</div>
											<div class="form-entity right-box">
												<label for="interviewDateFirm${i}">Date of Interview:
													<input type="date" name="interviewDateFirm${i}" class="form-control">
												</label>
												<!--<span style="font-size:em; color:red">DELETE</span>-->
												<img src='/xicon.jpeg' style="height:25px; width:25px; cursor:pointer;" onclick="deleteInterviewInfo(this)" >
											</div></div>`);
					}
					}
				}
				
				console.log(interviewInputAreasCount);
			}
		
		
	</script>

</body>

</html>